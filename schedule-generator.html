<!doctype html>
<html lang="ko">
<head>
  <!-- CDN Cache Bust: 2026-01-10T00:00:00 v6.2-pinned -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ì—…ì²´ ë°©ë¬¸ ìŠ¤ì¼€ì¤„ ìë™ ìƒì„±</title>

  <!-- Supabase JS (ë¸Œë¼ìš°ì € CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <!-- SortableJS -->
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.6/Sortable.min.js"></script>

  <style>
    :root{
      --bg:#f6f7fb;
      --card:#fff;
      --text:#111;
      --muted:#666;
      --line:#e6e8ec;
      --shadow:0 2px 10px rgba(0,0,0,.06);
      --radius:14px;

      --green:#2e7d32;
      --gray:#6b7280;
      --blue:#2563eb;
      --red:#dc2626;
      --yellow:#ca8a04;
      --orange:#ea580c;
      --sky:#0284c7;
      --purple:#7c3aed;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple SD Gothic Neo", "Noto Sans KR", "Malgun Gothic", sans-serif;
      background:var(--bg);
      color:var(--text);
    }

    /* ===== ìƒë‹¨ ë°” ===== */
    .topbar{
      position:sticky; top:0; z-index:20;
      background:rgba(246,247,251,.92);
      backdrop-filter: blur(8px);
      border-bottom:1px solid var(--line);
    }
    .topbar-inner{
      max-width:1400px; margin:0 auto;
      display:flex; align-items:center; gap:12px;
      padding:12px 14px;
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      font-weight:800;
    }
    .back-btn{
      background:none;
      border:none;
      font-size:20px;
      cursor:pointer;
      padding:4px 8px;
      border-radius:8px;
    }
    .back-btn:hover{ background:#eee; }
    .pill{
      font-size:12px; color:#0b3; background:#eafff0;
      border:1px solid #b9f6cf;
      padding:4px 10px; border-radius:999px;
    }
    .spacer{ flex:1; }
    .btn{
      border:1px solid var(--line);
      background:#fff; color:#111;
      padding:10px 12px;
      border-radius:12px;
      cursor:pointer;
      font-weight:700;
      box-shadow:0 1px 2px rgba(0,0,0,.04);
    }
    .btn:hover{ border-color:#cfd6e4; }
    .btn.primary{
      background:#111; color:#fff; border-color:#111;
    }
    .btn.danger{
      background:#fff; color:#b00020; border-color:#ffd2d8;
    }

    /* ===== 3íŒ¨ë„ ë ˆì´ì•„ì›ƒ =====
       - ì¢Œì¸¡: ì¡°ê±´/í•„í„°/ìƒì„±
       - ì¤‘ì•™: ìŠ¤ì¼€ì¤„(ê¸°ê°„ ë¦¬ìŠ¤íŠ¸)
       - ìš°ì¸¡: ìƒì„¸/ë¯¸ë°°ì •/íœ´ë¬´ ë“œë¡­ì¡´
    */
    .app{
      max-width:1400px;
      margin:14px auto 30px;
      padding:0 14px;
      display:grid;
      grid-template-columns: 360px 1fr 360px;
      gap:14px;
      align-items:start;
    }

    @media (max-width: 1200px){
      .app{ grid-template-columns: 360px 1fr; }
      .right{ grid-column: 1 / -1; }
    }
    @media (max-width: 820px){
      .app{ grid-template-columns: 1fr; }
      .left,.center,.right{ grid-column: 1 / -1; }
      .topbar-inner{ flex-wrap:wrap; }
    }

    .panel{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .panel .hd{
      padding:12px 14px;
      border-bottom:1px solid var(--line);
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      background:#fff;
    }
    .panel .hd .title{
      font-weight:800;
    }
    .panel .bd{
      padding:12px 14px;
    }

    .grid2{ display:grid; grid-template-columns:1fr 1fr; gap:10px; }
    label{ font-size:12px; color:var(--muted); display:block; margin-bottom:6px; }
    input[type="date"], input[type="text"], select{
      width:100%; padding:10px 10px;
      border:1px solid var(--line);
      border-radius:12px;
      outline:none;
      background:#fff;
    }

    .section{ margin-top:12px; }
    .section:first-child{ margin-top:0; }

    .hint{ font-size:12px; color:var(--muted); line-height:1.35; }
    .kpi{
      display:grid; grid-template-columns:1fr 1fr;
      gap:10px;
    }
    .kpi .box{
      border:1px solid var(--line); border-radius:12px;
      padding:10px;
      background:#fafbff;
    }
    .kpi .box .k{ font-size:12px; color:var(--muted); }
    .kpi .box .v{ font-size:16px; font-weight:900; margin-top:2px; }

    /* ===== í•„í„° UI ===== */
    .chiprow{ display:flex; flex-wrap:wrap; gap:8px; }
    .chip{
      border:1px solid var(--line);
      background:#fff;
      padding:8px 10px;
      border-radius:999px;
      font-size:12px;
      display:flex; align-items:center; gap:8px;
      cursor:pointer;
      user-select:none;
    }
    .chip[data-on="1"]{
      border-color:#111;
      box-shadow:0 0 0 2px rgba(0,0,0,.05);
    }
    .dot{ width:10px; height:10px; border-radius:999px; }
    .dot.green{ background:var(--green); }
    .dot.gray{ background:var(--gray); }
    .dot.blue{ background:var(--blue); }
    .dot.red{ background:var(--red); }
    .dot.yellow{ background:var(--yellow); }
    .dot.orange{ background:var(--orange); }
    .dot.sky{ background:var(--sky); }
    .dot.purple{ background:var(--purple); }

    .listbox{
      border:1px solid var(--line);
      border-radius:12px;
      padding:8px;
      background:#fff;
      max-height:220px;
      overflow:auto;
    }
    .row{
      display:flex; align-items:center; gap:8px;
      padding:6px 4px;
      border-bottom:1px dashed #eee;
    }
    .row:last-child{ border-bottom:none; }
    .row input{ margin:0; }
    .row .meta{ margin-left:auto; font-size:12px; color:var(--muted); }

    .selbar{
      display:flex; gap:8px; flex-wrap:wrap;
      margin-top:8px;
    }
    .mini{
      padding:8px 10px;
      border-radius:12px;
      border:1px solid var(--line);
      background:#fff;
      cursor:pointer;
      font-weight:700;
      font-size:12px;
    }

    /* ===== ì¤‘ì•™ ìŠ¤ì¼€ì¤„(ê¸°ê°„ ë¦¬ìŠ¤íŠ¸) ===== */
    .center .bd{ padding:0; }
    .calendar{
      padding:12px 14px;
      display:flex; flex-direction:column; gap:10px;
      max-height: calc(100vh - 120px);
      overflow:auto;
    }
    .day-card{
      border:1px solid var(--line);
      border-radius:14px;
      background:#fff;
      overflow:hidden;
      flex-shrink:0;  /* ì¹´ë“œê°€ ì¶•ì†Œë˜ì§€ ì•Šë„ë¡ ë°©ì§€ */
    }
    .day-hd{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
      padding:10px 12px;
      border-bottom:1px solid #f0f2f6;
      background:#fbfcff;
    }
    .day-hd .leftline{
      display:flex; align-items:center; gap:10px;
      font-weight:900;
    }
    .badge{
      font-size:11px;
      padding:3px 8px;
      border-radius:999px;
      border:1px solid var(--line);
      background:#fff;
      color:#111;
      font-weight:800;
    }
    .badge.holiday{ border-color:#ffd2d8; background:#fff5f6; color:#b00020; }
    .badge.weekend{ border-color:#dbeafe; background:#eff6ff; color:#1d4ed8; }
    .badge.off{ border-color:#d1fae5; background:#ecfdf5; color:#065f46; }
    .badge.disabled{ border-color:#eee; background:#f7f7f7; color:#999; }
    .badge.location{ border-color:#fef3c7; background:#fffbeb; color:#92400e; }

    .day-meta{ font-size:12px; color:var(--muted); display:flex; gap:8px; align-items:center; }
    .day-actions{ display:flex; gap:8px; }
    .btn-sm{
      padding:6px 10px; border-radius:10px;
      border:1px solid var(--line);
      background:#fff;
      cursor:pointer;
      font-weight:800;
      font-size:12px;
    }

    /* day list (ë“œë˜ê·¸ ëŒ€ìƒ) */
    .day-list{
      list-style:none;
      margin:0;
      padding:10px 10px 12px;
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      min-height:46px;
    }
    .day-list.disabled{
      background:#fafafa;
      opacity:.65;
      pointer-events:none;
    }

    /* ì—…ì²´ ì¹©(ë“œë˜ê·¸ ì•„ì´í…œ) */
    .company-item{
      border:1px solid var(--line);
      background:#fff;
      padding:8px 10px;
      border-radius:999px;
      font-size:12px;
      display:flex; align-items:center; gap:8px;
      cursor:grab;
      user-select:none;
      box-shadow:0 1px 2px rgba(0,0,0,.04);
    }
    .company-item:active{ cursor:grabbing; }
    .company-item .sub{ font-size:11px; color:var(--muted); font-weight:700; }
    .company-item .visit-info{ font-size:10px; color:#0284c7; font-weight:700; margin-left:auto; }
    .company-item .x{ margin-left:4px; color:#999; font-weight:900; cursor:pointer; }
    /* v5.1: ìˆœë²ˆ í‘œì‹œ ìŠ¤íƒ€ì¼ */
    .company-item .order-num{
      background:#2563eb; color:#fff;
      font-size:10px; font-weight:700;
      min-width:18px; height:18px;
      border-radius:50%;
      display:flex; align-items:center; justify-content:center;
      flex-shrink:0;
    }
    /* v5.1: ì´ì „ ì—…ì²´ì™€ì˜ ê±°ë¦¬ í‘œì‹œ */
    .company-item .distance-info{
      font-size:9px; color:#059669; font-weight:600;
      background:#d1fae5; padding:2px 6px; border-radius:8px;
    }
    /* v6.2.2: ìƒì„¸ë³´ê¸° ë²„íŠ¼ ìŠ¤íƒ€ì¼ (2026-01-12 ChatGPT + Claude í˜‘ì—…) */
    .company-item .btn-detail{
      cursor:pointer;
      padding:0 6px;
      opacity:0.5;
      font-size:11px;
      flex-shrink:0;
      transition:opacity .15s;
    }
    .company-item .btn-detail:hover{
      opacity:1;
    }
    .company-item:hover .btn-detail{
      opacity:0.8;
    }

    /* ë‚ ì§œ ì¹´ë“œ ì¶”ê°€ ìŠ¤íƒ€ì¼ */
    .day-date{ font-weight:900; }
    .color-dots{ display:flex; gap:3px; margin-left:8px; }
    .day-disabled{ opacity:0.6; }
    .day-disabled .day-hd{ background:#f7f7f7; }

    .slotline{
      padding:0 12px 10px;
      font-size:12px;
      color:var(--muted);
      display:flex; justify-content:space-between;
    }

    /* ===== ìš°ì¸¡ íŒ¨ë„: ë¯¸ë°°ì • / íœ´ë¬´ ë“œë¡­ì¡´ ===== */
    .dropzone{
      border:2px dashed #cfd6e4;
      border-radius:14px;
      padding:12px;
      background:#fbfcff;
    }
    .dropzone .dz-title{
      font-weight:900;
      margin-bottom:6px;
    }
    .dropzone .dz-desc{
      font-size:12px;
      color:var(--muted);
      line-height:1.35;
    }
    .drop-list{
      list-style:none;
      margin:10px 0 0;
      padding:10px;
      border:1px solid var(--line);
      border-radius:12px;
      background:#fff;
      min-height:46px;
      display:flex;
      flex-wrap:wrap;
      gap:8px;
    }

    /* ===== v6.2 ê³ ì • ì—…ì²´ UI (2026-01-10) ===== */
    .pin-section{
      background:#fffbeb;
      border:1px solid #fcd34d;
      border-radius:12px;
      padding:12px;
      margin-top:12px;
    }
    .pin-section .pin-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:10px;
    }
    .pin-section .pin-title{
      font-weight:700;
      font-size:14px;
      color:#92400e;
    }
    .btn-pin-mode{
      background:#fef3c7;
      border:1px solid #fcd34d;
      color:#92400e;
      padding:6px 12px;
      border-radius:8px;
      cursor:pointer;
      font-weight:600;
      font-size:12px;
      transition:all .2s;
    }
    .btn-pin-mode:hover{
      background:#fde68a;
    }
    .btn-pin-mode.active{
      background:#f59e0b;
      color:#fff;
      border-color:#d97706;
    }
    .pin-badge{
      background:#ef4444;
      color:#fff;
      font-size:10px;
      font-weight:700;
      padding:2px 6px;
      border-radius:999px;
      margin-left:6px;
      display:none;
    }
    .pin-date-selector{
      display:none;
      margin-top:10px;
    }
    .pin-date-selector label{
      margin-bottom:4px;
    }
    .pinned-list{
      margin-top:10px;
      max-height:150px;
      overflow-y:auto;
    }
    .pinned-item{
      display:flex;
      align-items:center;
      gap:8px;
      padding:6px 8px;
      background:#fff;
      border:1px solid #e5e7eb;
      border-radius:8px;
      margin-bottom:6px;
      font-size:12px;
    }
    .pinned-date{
      color:#059669;
      font-weight:600;
      min-width:90px;
    }
    .pinned-name{
      flex:1;
      color:#374151;
    }
    .btn-remove-pin{
      background:#fee2e2;
      border:1px solid #fecaca;
      color:#dc2626;
      width:20px;
      height:20px;
      border-radius:50%;
      cursor:pointer;
      font-size:14px;
      line-height:1;
      padding:0;
    }
    .btn-remove-pin:hover{
      background:#fecaca;
    }
    .btn-clear-pins{
      background:#fee2e2;
      border:1px solid #fecaca;
      color:#dc2626;
      padding:4px 10px;
      border-radius:6px;
      cursor:pointer;
      font-size:11px;
      font-weight:600;
    }
    .btn-clear-pins:hover{
      background:#fecaca;
    }
    /* ê³ ì •ëœ ì—…ì²´ ì¹´ë“œ í‘œì‹œ */
    .company-card.pinned,
    .company-item.pinned{
      border-left:3px solid #f59e0b;
      background:#fffbeb;
    }
    .company-card .pin-icon,
    .company-item .pin-icon{
      color:#f59e0b;
      margin-left:4px;
    }
    /* ê³ ì •ìš© ì—…ì²´ ëª©ë¡ */
    .pin-company-list{
      max-height:200px;
      overflow-y:auto;
      border:1px solid #e5e7eb;
      border-radius:8px;
      margin-top:10px;
      display:none;
    }
    .pin-company-item{
      display:flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      border-bottom:1px solid #f3f4f6;
      cursor:pointer;
      font-size:12px;
      transition:background .15s;
    }
    .pin-company-item:last-child{
      border-bottom:none;
    }
    .pin-company-item:hover{
      background:#fef3c7;
    }
    .pin-company-item.is-pinned{
      background:#fef3c7;
      border-left:3px solid #f59e0b;
    }
    .pin-company-item .company-name{
      flex:1;
      font-weight:500;
    }
    .pin-company-item .company-region{
      color:#6b7280;
      font-size:11px;
    }
    .pin-search-box{
      margin-top:10px;
    }
    .pin-search-box input{
      width:100%;
      padding:8px 10px;
      border:1px solid #e5e7eb;
      border-radius:8px;
      font-size:12px;
    }

    .toast{
      position:fixed;
      left:50%;
      bottom:18px;
      transform:translateX(-50%);
      background:#111;
      color:#fff;
      padding:10px 12px;
      border-radius:12px;
      font-size:13px;
      box-shadow:0 10px 30px rgba(0,0,0,.25);
      opacity:0;
      pointer-events:none;
      transition:opacity .2s ease;
      z-index:50;
    }
    .toast.on{ opacity:1; }

    .warn{
      border:1px solid #ffe6a7;
      background:#fff7db;
      padding:10px 12px;
      border-radius:12px;
      font-size:12px;
      color:#6b4e00;
      line-height:1.35;
    }

    .info{
      border:1px solid #bfdbfe;
      background:#eff6ff;
      padding:10px 12px;
      border-radius:12px;
      font-size:12px;
      color:#1e40af;
      line-height:1.35;
    }

    .muted{ color:var(--muted); }
    .small{ font-size:12px; }

    /* ===== Pre-flight ì ê²€ ëª¨ë‹¬ (2026-01-04 ChatGPT + Claude í˜‘ì—…) ===== */
    .preflight-overlay{
      position:fixed; inset:0;
      background:rgba(0,0,0,.5);
      z-index:100;
      display:none;
      align-items:center;
      justify-content:center;
      padding:20px;
    }
    .preflight-overlay.show{ display:flex; }
    .preflight-modal{
      background:#fff;
      border-radius:16px;
      max-width:700px;
      width:100%;
      max-height:85vh;
      overflow:hidden;
      display:flex;
      flex-direction:column;
      box-shadow:0 20px 50px rgba(0,0,0,.2);
    }
    .preflight-header{
      padding:16px 20px;
      border-bottom:1px solid var(--line);
      display:flex;
      align-items:center;
      gap:12px;
    }
    .preflight-header .icon{
      width:40px; height:40px;
      background:#fef3c7;
      border-radius:10px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:20px;
    }
    .preflight-header .title{ font-weight:800; font-size:16px; }
    .preflight-header .subtitle{ font-size:13px; color:var(--muted); }
    .preflight-header .close-btn{
      margin-left:auto;
      background:none;
      border:none;
      font-size:24px;
      cursor:pointer;
      color:#999;
      padding:4px;
    }
    .preflight-header .close-btn:hover{ color:#333; }
    .preflight-body{
      padding:16px 20px;
      overflow-y:auto;
      flex:1;
    }
    .preflight-stats{
      display:grid;
      grid-template-columns:repeat(3,1fr);
      gap:12px;
      margin-bottom:16px;
    }
    .preflight-stat{
      border:1px solid var(--line);
      border-radius:12px;
      padding:12px;
      text-align:center;
    }
    .preflight-stat .num{
      font-size:24px;
      font-weight:900;
    }
    .preflight-stat .label{
      font-size:12px;
      color:var(--muted);
      margin-top:4px;
    }
    .preflight-stat.warning{ border-color:#fbbf24; background:#fffbeb; }
    .preflight-stat.warning .num{ color:#d97706; }
    .preflight-actions{
      display:flex;
      gap:10px;
      margin-bottom:16px;
    }
    .preflight-actions .btn{
      flex:1;
      text-align:center;
      padding:12px;
    }
    .preflight-actions .btn.secondary{
      background:#f3f4f6;
      border-color:#e5e7eb;
    }
    .preflight-list{
      border:1px solid var(--line);
      border-radius:12px;
      max-height:250px;
      overflow-y:auto;
    }
    .preflight-item{
      padding:10px 14px;
      border-bottom:1px solid var(--line);
      display:flex;
      align-items:center;
      gap:12px;
    }
    .preflight-item:last-child{ border-bottom:none; }
    .preflight-item .name{
      font-weight:600;
      flex:1;
    }
    .preflight-item .address{
      font-size:12px;
      color:var(--muted);
      flex:2;
    }
    .preflight-item .status{
      font-size:11px;
      padding:4px 8px;
      border-radius:999px;
    }
    .preflight-item .status.error{
      background:#fee2e2;
      color:#dc2626;
    }
    .preflight-item .status.pending{
      background:#fef3c7;
      color:#d97706;
    }
    .preflight-item .status.success{
      background:#dcfce7;
      color:#16a34a;
    }
    .preflight-footer{
      padding:14px 20px;
      border-top:1px solid var(--line);
      display:flex;
      justify-content:flex-end;
      gap:10px;
      background:#fafafa;
    }
    .preflight-progress{
      margin:12px 0;
      display:none;
    }
    .preflight-progress.show{ display:block; }
    .preflight-progress .bar{
      height:8px;
      background:#e5e7eb;
      border-radius:999px;
      overflow:hidden;
    }
    .preflight-progress .fill{
      height:100%;
      background:#2563eb;
      border-radius:999px;
      transition:width .3s;
    }
    .preflight-progress .text{
      font-size:12px;
      color:var(--muted);
      margin-top:6px;
      text-align:center;
    }

    /* ===== ìŠ¤ì¼€ì¤„ ë¶ˆëŸ¬ì˜¤ê¸° ì•„ì´í…œ ìŠ¤íƒ€ì¼ ===== */
    .schedule-load-item{
      padding:14px 16px;
      border:1px solid var(--line);
      border-radius:12px;
      cursor:pointer;
      transition:all .15s;
      display:flex;
      align-items:center;
      gap:14px;
    }
    .schedule-load-item:hover{
      border-color:#2563eb;
      background:#f0f7ff;
    }
    .schedule-load-item.selected{
      border-color:#2563eb;
      background:#eff6ff;
      box-shadow:0 0 0 2px rgba(37,99,235,.2);
    }
    .schedule-load-item .info{ flex:1; }
    .schedule-load-item .plan-name{
      font-weight:700;
      font-size:15px;
      margin-bottom:4px;
    }
    .schedule-load-item .plan-meta{
      font-size:13px;
      color:var(--muted);
      display:flex;
      gap:12px;
    }
    .schedule-load-item .plan-date{
      font-size:12px;
      color:#999;
      margin-top:4px;
    }
    .schedule-load-item .check-icon{
      width:24px;
      height:24px;
      border:2px solid #ddd;
      border-radius:50%;
      display:flex;
      align-items:center;
      justify-content:center;
      color:transparent;
      font-size:14px;
    }
    .schedule-load-item.selected .check-icon{
      border-color:#2563eb;
      background:#2563eb;
      color:#fff;
    }
  </style>
</head>

<body>
  <div class="topbar">
    <div class="topbar-inner">
      <button class="back-btn" onclick="location.href='employee-dashboard.html'">&larr;</button>
      <div class="brand">ë‚¨ê²½ìŠ¤í‹¸ Â· ì—…ì²´ ë°©ë¬¸ ìŠ¤ì¼€ì¤„ ìƒì„±</div>
      <div id="saveStatePill" class="pill" style="display:none;">ì €ì¥ í•„ìš”</div>
      <div class="spacer"></div>
      <button id="btnPreview" class="btn primary">ìŠ¤ì¼€ì¤„ ìƒì„±</button>
      <button id="btnSave" class="btn primary">ì €ì¥</button>
      <button id="btnLoad" class="btn">ë¶ˆëŸ¬ì˜¤ê¸°</button>
      <button id="btnReset" class="btn danger">ì´ˆê¸°í™”</button>
    </div>
  </div>

  <!-- ===== Pre-flight ì ê²€ ëª¨ë‹¬ (2026-01-04 ChatGPT + Claude í˜‘ì—…) ===== -->
  <div id="preflightOverlay" class="preflight-overlay">
    <div class="preflight-modal">
      <div class="preflight-header">
        <div class="icon">âš ï¸</div>
        <div>
          <div class="title">ìŠ¤ì¼€ì¤„ ìƒì„± ì „ ì ê²€</div>
          <div class="subtitle">ì¢Œí‘œ ë¯¸ë“±ë¡ ì—…ì²´ê°€ ìˆìŠµë‹ˆë‹¤</div>
        </div>
        <button class="close-btn" id="preflightClose">&times;</button>
      </div>
      <div class="preflight-body">
        <div class="preflight-stats">
          <div class="preflight-stat">
            <div class="num" id="pfTotal">0</div>
            <div class="label">ì „ì²´ ì—…ì²´</div>
          </div>
          <div class="preflight-stat">
            <div class="num" id="pfReady">0</div>
            <div class="label">ì¢Œí‘œ ì™„ë£Œ</div>
          </div>
          <div class="preflight-stat warning">
            <div class="num" id="pfPending">0</div>
            <div class="label">ì¢Œí‘œ ë¯¸ë“±ë¡</div>
          </div>
        </div>

        <div class="preflight-actions">
          <button class="btn secondary" id="pfRetryGeocode">
            ğŸ”„ ìë™ ì§€ì˜¤ì½”ë”© ì¬ì‹œë„
          </button>
          <button class="btn secondary" id="pfRefresh">
            ğŸ”ƒ ìƒˆë¡œê³ ì¹¨
          </button>
        </div>

        <div class="preflight-progress" id="pfProgress">
          <div class="bar"><div class="fill" id="pfProgressFill" style="width:0%"></div></div>
          <div class="text" id="pfProgressText">ì²˜ë¦¬ ì¤‘...</div>
        </div>

        <div style="font-size:13px; margin-bottom:10px; color:var(--muted);">
          <b>ì¢Œí‘œ ë¯¸ë“±ë¡ ì—…ì²´ ëª©ë¡</b> (ì£¼ì†Œ ì˜¤ë¥˜ ë˜ëŠ” ë¹ˆì¹¸)
        </div>
        <div class="preflight-list" id="pfList">
          <!-- ì—…ì²´ ëª©ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë¨ -->
        </div>
      </div>
      <div class="preflight-footer">
        <button class="btn" id="pfSkip">ì œì™¸í•˜ê³  ìƒì„±</button>
        <button class="btn primary" id="pfGenerate" disabled>ìŠ¤ì¼€ì¤„ ìƒì„±</button>
      </div>
    </div>
  </div>

  <!-- ===== ìŠ¤ì¼€ì¤„ ë¶ˆëŸ¬ì˜¤ê¸° ëª¨ë‹¬ ===== -->
  <div id="loadScheduleOverlay" class="preflight-overlay">
    <div class="preflight-modal" style="max-width:500px;">
      <div class="preflight-header">
        <div class="icon">ğŸ“‹</div>
        <div>
          <div class="title">ì €ì¥ëœ ìŠ¤ì¼€ì¤„ ë¶ˆëŸ¬ì˜¤ê¸°</div>
          <div class="desc">ë¶ˆëŸ¬ì˜¬ ìŠ¤ì¼€ì¤„ì„ ì„ íƒí•˜ì„¸ìš”</div>
        </div>
      </div>
      <div class="preflight-body" style="max-height:400px; overflow-y:auto;">
        <div id="loadScheduleList" style="display:flex; flex-direction:column; gap:8px;">
          <!-- ìŠ¤ì¼€ì¤„ ëª©ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë¨ -->
        </div>
        <div id="loadScheduleEmpty" style="display:none; text-align:center; padding:40px 20px; color:var(--muted);">
          ì €ì¥ëœ ìŠ¤ì¼€ì¤„ì´ ì—†ìŠµë‹ˆë‹¤.
        </div>
        <div id="loadScheduleLoading" style="text-align:center; padding:40px 20px; color:var(--muted);">
          ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
        </div>
      </div>
      <div class="preflight-footer">
        <button class="btn" id="loadScheduleCancel">ì·¨ì†Œ</button>
        <button class="btn danger" id="loadScheduleDelete" style="display:none;">ì‚­ì œ</button>
      </div>
    </div>
  </div>

  <div class="app">
    <!-- ===== ì¢Œì¸¡ íŒ¨ë„: ì¡°ê±´/í•„í„° ===== -->
    <section class="panel left">
      <div class="hd">
        <div class="title">ì¡°ê±´/í•„í„°</div>
        <div class="muted small" id="loadState">ë¡œë”©...</div>
      </div>
      <div class="bd">
        <div class="section">
          <div class="grid2">
            <div>
              <label>ì‹œì‘ì¼</label>
              <input type="date" id="startDate" />
            </div>
            <div>
              <label>ì¢…ë£Œì¼</label>
              <input type="date" id="endDate" />
            </div>
          </div>
          <div style="margin-top:10px;" class="kpi">
            <div class="box">
              <div class="k">ê·¼ë¬´ì¼(ì£¼ë§/ê³µíœ´ì¼ ì œì™¸)</div>
              <div class="v" id="workdayCount">-</div>
            </div>
            <div class="box">
              <div class="k">ì„ íƒ ì—…ì²´ ìˆ˜</div>
              <div class="v" id="selectedCount">0</div>
            </div>
          </div>
          <div style="margin-top:10px;" class="hint" id="rangeHint">
            ê¸°ê°„ì„ ì„ íƒí•˜ë©´ ìë™ìœ¼ë¡œ ì£¼ë§/ê³µíœ´ì¼ì„ ì œì™¸í•˜ì—¬ ê·¼ë¬´ì¼ì„ ê³„ì‚°í•©ë‹ˆë‹¤.
          </div>
        </div>

        <div class="section">
          <label>í•˜ë£¨ ë°©ë¬¸ ì—…ì²´ ìˆ˜ ì˜µì…˜</label>
          <div class="listbox" style="max-height:none;">
            <div class="row">
              <input type="radio" name="cap" value="1-3" checked />
              <div><b>1~3ê°œ</b> <span class="muted small">(ëª©í‘œ 2)</span></div>
            </div>
            <div class="row">
              <input type="radio" name="cap" value="4-5" />
              <div><b>4~5ê°œ</b> <span class="muted small">(ëª©í‘œ 5)</span></div>
            </div>
            <div class="row">
              <input type="radio" name="cap" value="6-8" />
              <div><b>6~8ê°œ</b> <span class="muted small">(ëª©í‘œ 7)</span></div>
            </div>
            <div class="row">
              <input type="radio" name="cap" value="9-11" />
              <div><b>9~11ê°œ</b> <span class="muted small">(ëª©í‘œ 10)</span></div>
            </div>
          </div>
        </div>

        <div class="section">
          <label>v6.1 í†µí•© ì•Œê³ ë¦¬ì¦˜ (ChatGPT í˜‘ì—…)</label>
          <div class="hint">
            <b>ê±°ë¦¬ ìµœì í™”</b>: Nearest Neighbor + 2-optë¡œ ìµœë‹¨ ê²½ë¡œ ê³„ì‚°<br/>
            <b>ì§€ì—­ ì¿¨ë‹¤ìš´</b>: ê°™ì€ ì§€ì—­ 3~4ì¼ ì—°ì† ë°©ë¬¸ ì–µì œ<br/>
            <b>ì›” 2íšŒ ì œí•œ</b>: ì›” 3íšŒ ì´ìƒ ë°©ë¬¸ ìë™ ì°¨ë‹¨<br/>
            <b>ì›”/ê¸ˆ ê·¼ê±°ë¦¬</b>: ì›”ìš”ì¼/ê¸ˆìš”ì¼ì€ ë³¸ì‚¬ ê°€ê¹Œìš´ ì§€ì—­ ìš°ì„ <br/>
            <b>ì´ë™ë¹„ìš© ê³ ë ¤</b>: ë¨¼ ì—…ì²´ì¼ìˆ˜ë¡ ë°°ì • ìš°ì„ ìˆœìœ„ ë‚®ìŒ
          </div>
        </div>

        <!-- ì¢Œí‘œ ê´€ë¦¬ ì„¹ì…˜ (2026-01-04 ì¶”ê°€) -->
        <div class="section" id="geocodeSection">
          <label>ğŸ“ ì—…ì²´ ì¢Œí‘œ ê´€ë¦¬</label>
          <div class="info" id="geocodeStats" style="margin-bottom:10px;">
            ì¢Œí‘œ í†µê³„ ë¡œë”© ì¤‘...
          </div>
          <div class="selbar">
            <button class="mini" id="btnBatchGeocode" style="background:#2563eb;color:#fff;">
              ì¼ê´„ ì§€ì˜¤ì½”ë”© ì‹¤í–‰
            </button>
            <button class="mini" id="btnRefreshGeoStats">í†µê³„ ìƒˆë¡œê³ ì¹¨</button>
          </div>
          <div id="geocodeProgress" style="display:none;margin-top:10px;">
            <div style="background:#e5e7eb;border-radius:8px;overflow:hidden;">
              <div id="geocodeProgressBar" style="background:#2563eb;height:8px;width:0%;transition:width 0.3s;"></div>
            </div>
            <div id="geocodeProgressText" class="hint" style="margin-top:6px;"></div>
          </div>
          <div class="hint" style="margin-top:8px;">
            ì¹´ì¹´ì˜¤ë§µ APIë¡œ ì£¼ì†Œâ†’ì¢Œí‘œ ë³€í™˜ í›„ Supabaseì— ì €ì¥í•©ë‹ˆë‹¤.<br/>
            ì¢Œí‘œê°€ ìˆì–´ì•¼ "ê°€ì¥ ê°€ê¹Œìš´ ì—…ì²´" ê²½ë¡œ ìµœì í™”ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.
          </div>
        </div>

        <div class="section">
          <label>ìƒ‰ìƒ í•„í„° (ë©€í‹°)</label>
          <div class="chiprow" id="colorChips"></div>
        </div>

        <div class="section">
          <label>ì§€ì—­ í•„í„° (ë©€í‹°)</label>
          <div class="listbox" id="regionList"></div>
          <div class="selbar">
            <button class="mini" id="btnRegionAll">ì „ì²´ ì„ íƒ</button>
            <button class="mini" id="btnRegionNone">ì „ì²´ í•´ì œ</button>
          </div>
        </div>

        <div class="section">
          <label>ì—…ì²´ ê²€ìƒ‰/ì„ íƒ</label>
          <input type="text" id="companySearch" placeholder="ì—…ì²´ëª… ê²€ìƒ‰ (ì˜ˆ: ë‚¨ê²½, ì² ê°•, OOìƒì‚¬)" />
          <div class="selbar">
            <button class="mini" id="btnSelectAllFiltered">í•„í„° ê²°ê³¼ ì „ì²´ ì„ íƒ</button>
            <button class="mini" id="btnClearSelected">ì„ íƒ ì—…ì²´ ë¹„ìš°ê¸°</button>
          </div>
          <div class="hint" style="margin-top:8px;">
            "ì„ íƒ ì—…ì²´ ìˆ˜"ê°€ 0ì´ë©´, ë¯¸ë¦¬ë³´ê¸° ìƒì„± ì‹œ "í˜„ì¬ í•„í„° ê²°ê³¼ ì „ì²´"ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
          </div>
        </div>

        <div class="section">
          <div class="warn" id="estimateBox">
            ê¸°ê°„/í•„í„°ë¥¼ ì„¤ì •í•˜ë©´ "í•„ìš” ì¼ìˆ˜ ì¶”ì •"ì´ í‘œì‹œë©ë‹ˆë‹¤.
          </div>
        </div>

        <!-- ===== v6.2 ê³ ì • ì—…ì²´ ì„¹ì…˜ (2026-01-10 ChatGPT + Claude í˜‘ì—…) ===== -->
        <div class="section pin-section">
          <div class="pin-header">
            <span class="pin-title">ğŸ“Œ ì—…ì²´ ê³ ì • ë°°ì •</span>
            <div>
              <button id="btnPinMode" class="btn-pin-mode" onclick="togglePinMode()">
                ğŸ“Œ ê³ ì • ëª¨ë“œ
              </button>
              <span id="pinBadge" class="pin-badge">0</span>
            </div>
          </div>

          <div id="pinDateSelector" class="pin-date-selector">
            <label>ê³ ì •í•  ë‚ ì§œ ì„ íƒ</label>
            <input type="date" id="pinDateInput" />
            <div class="hint" style="margin-top:6px;">
              ë‚ ì§œ ì„ íƒ í›„ ì•„ë˜ ì—…ì²´ ëª©ë¡ì—ì„œ ì—…ì²´ë¥¼ í´ë¦­í•˜ë©´ í•´ë‹¹ ë‚ ì§œì— ê³ ì •ë©ë‹ˆë‹¤.
            </div>

            <div class="pin-search-box">
              <input type="text" id="pinCompanySearch" placeholder="ì—…ì²´ëª… ê²€ìƒ‰..." oninput="renderPinCompanyList()" />
            </div>

            <div id="pinCompanyList" class="pin-company-list">
              <!-- ì—…ì²´ ëª©ë¡ì´ ì—¬ê¸°ì— ë Œë”ë§ë¨ -->
            </div>
          </div>

          <div id="pinnedList" class="pinned-list">
            <div class="hint">ê³ ì •ëœ ì—…ì²´ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
          </div>

          <div style="margin-top:8px; display:flex; justify-content:flex-end;">
            <button class="btn-clear-pins" onclick="clearAllPins()">ì „ì²´ ê³ ì • í•´ì œ</button>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== ì¤‘ì•™ íŒ¨ë„: ìŠ¤ì¼€ì¤„(ê¸°ê°„ ë¦¬ìŠ¤íŠ¸) ===== -->
    <section class="panel center">
      <div class="hd">
        <div class="title">ìŠ¤ì¼€ì¤„ (ê¸°ê°„ ë¦¬ìŠ¤íŠ¸)</div>
        <div class="muted small" id="calendarMeta">-</div>
      </div>
      <div class="bd">
        <div class="calendar" id="calendar">
          <div class="hint">ì¢Œì¸¡ì—ì„œ ì¡°ê±´ ì„¤ì • â†’ "ë¯¸ë¦¬ë³´ê¸° ìƒì„±"ì„ ëˆ„ë¥´ì„¸ìš”.</div>
        </div>
      </div>
    </section>

    <!-- ===== ìš°ì¸¡ íŒ¨ë„: íœ´ë¬´ ë“œë¡­ì¡´ / ë¯¸ë°°ì • í’€ ===== -->
    <section class="panel right">
      <div class="hd">
        <div class="title">í¸ì§‘ ë„êµ¬</div>
        <div class="muted small" id="editMeta">ë“œë˜ê·¸ë¡œ ì¡°ì •</div>
      </div>
      <div class="bd">
        <div class="dropzone">
          <div class="dz-title">íœ´ë¬´ ì§€ì • ë“œë¡­ì¡´</div>
          <div class="dz-desc">
            ë‚ ì§œ ì¹´ë“œì—ì„œ ì—…ì²´ í•˜ë‚˜ë¥¼ ì—¬ê¸°ë¡œ ë“œë¡­í•˜ë©´<br/>
            <b>ê·¸ ë‚ ì§œë¥¼ "íœ´ë¬´"ë¡œ ì§€ì •</b>í•˜ê³ , í•´ë‹¹ ë‚ ì§œì˜ ëª¨ë“  ì—…ì²´ë¥¼ ë¯¸ë°°ì •ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.
          </div>
          <ul class="drop-list" id="offDropList" aria-label="íœ´ë¬´ ë“œë¡­ì¡´"></ul>
        </div>

        <div class="section"></div>

        <div class="dropzone" style="margin-top:12px;">
          <div class="dz-title">ë¯¸ë°°ì • ì—…ì²´</div>
          <div class="dz-desc">ê¸°ê°„ ë¶€ì¡±/íœ´ë¬´ ì§€ì •/ìˆ˜ë™ ì´ë™ìœ¼ë¡œ ë‚¨ì€ ì—…ì²´ë“¤ì´ ì—¬ê¸°ì— ëª¨ì…ë‹ˆë‹¤.</div>
          <ul class="drop-list" id="unassignedList" aria-label="ë¯¸ë°°ì • ë¦¬ìŠ¤íŠ¸"></ul>
        </div>

        <div class="section" style="margin-top:12px;">
          <div class="hint">
            íŒ) ë¯¸ë°°ì • â†’ ë‚ ì§œë¡œ ë“œë˜ê·¸í•˜ë©´ ë°°ì •ë©ë‹ˆë‹¤. ë‚ ì§œ ë‚´ì—ì„œë„ ìˆœì„œ ë³€ê²½ ê°€ëŠ¥í•©ë‹ˆë‹¤.
          </div>
        </div>
      </div>
    </section>
  </div>

  <div id="toast" class="toast">-</div>

  <!-- ì¸ì¦ ë° ë°ì´í„°ë² ì´ìŠ¤ ë¡œë“œ -->
  <!-- â˜… ChatGPT ë¦¬ë·°: ìºì‹œ ë²„ìŠ¤íŒ… - ë²„ì „ í˜•ì‹ ë³€ê²½ (20260104b - UTC ì‹œê°„ëŒ€ ë²„ê·¸ ìˆ˜ì •) -->
  <script src="shared-assets/js/auth.js?v=20260104d"></script>
  <script src="database.js?v=20260104d"></script>
  <script src="route-optimizer.js?v=20260104k"></script>
  <script src="schedule-generator.js?v=20260112-v622f"></script>
</body>
</html>
