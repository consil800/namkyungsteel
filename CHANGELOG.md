# 변경 이력 📋

> **남경철강 업무일지 시스템**의 버전별 변경사항을 기록합니다.

---

## [v13.7.2] - 2025-09-22 🔧

### 🔍 검색 시스템 완전 개선
- **3가지 검색 조건**: 지역 + 업체명 + 색상 필터링으로 확장
- **색상 기반 필터링**: 방문 기록 없는 색상(빨강, 보라, 회색) 제외 기능 추가
- **검색 버튼 방식**: 지역 선택 시 즉시 검색 → 버튼 클릭 검색으로 변경
- **체크박스 UI**: "방문 기록 없는 색상 제외" 체크박스 추가 (기본값: 체크됨)

### 🔄 검색 상태 복원 완전 수정
- **이벤트 객체 구분**: handleSearch 함수에서 이벤트와 상태 객체 구분 처리
- **상태 저장 통합**: 중복된 saveSearchState 함수 제거 및 전역 상태 관리 개선
- **복원 로직 개선**: 저장된 상태값을 직접 전달하여 DOM 의존성 제거
- **뒤로가기 완벽 지원**: 모든 검색 조건(지역, 업체명, 체크박스) 상태 복원

### 🎨 UI/UX 개선
- **체크박스 배치**: 텍스트 → 체크박스 순서로 변경
- **간격 조정**: 텍스트와 체크박스 사이 1px 간격으로 최적화
- **크기 고정**: 체크박스 16x16 크기 고정 (200x16 오류 수정)
- **반응형 지원**: 데스크톱과 모바일 모두 동일한 간격 유지

### 🛠️ 코드 품질 개선
- **함수 전역 노출**: handleSearch 함수 전역 노출로 재사용성 향상
- **디버깅 로그**: 상세한 검색 과정 로그 추가
- **에러 처리**: 잘못된 검색 상태 자동 정리 기능 추가
- **성능 최적화**: 불필요한 중복 검색 방지

---

## [v13.7.1] - 2025-01-20 🔧

### 🔍 검색 상태 복원 버그 수정
- **뒤로가기 검색 상태 복원**: 업체 상세에서 뒤로가기 시 검색 상태 완벽 복원
- **restoreSearchState 개선**: `handleSearch()` 대신 `searchCompanies()` 직접 호출로 타이밍 이슈 해결
- **0개 결과 문제 해결**: DOM 업데이트 전 검색 실행으로 인한 빈 결과 문제 수정
- **검색 결과 정확성**: 저장된 검색 조건으로 직접 API 호출하여 정확한 결과 보장

### 🔄 네비게이션 완전 수정
- **모든 뒤로가기 통일**: 모든 페이지의 뒤로가기 버튼을 `history.back()` 방식으로 통일
- **company-detail.js 수정**: 상세 페이지에서 뒤로가기 시 검색 상태 100% 유지
- **타이밍 최적화**: 200ms 지연 후 검색 상태 복원으로 안정성 확보

### 🛠️ 안정성 개선
- **에러 핸들링 강화**: 검색 상태 복원 실패 시 적절한 에러 로깅
- **검색 로직 분리**: UI 의존성 제거로 상태 복원 안정성 향상
- **디버깅 로그 개선**: 검색 상태 복원 과정의 상세 로그 추가

---

## [v13.7.0] - 2025-01-20 🚀

### 🔍 검색 시스템 대폭 개선
- **검색 상태 유지**: 페이지 이동 후에도 검색 상태 자동 복원
- **검색 우선 UI**: 초기 로드 시 빈 목록으로 시작, 검색 권장
- **SessionStorage 활용**: 검색 조건 자동 저장 및 복원
- **성능 최적화**: Lazy Loading 방식으로 불필요한 데이터 로드 방지

### 🎨 업체 등록 개선
- **색상 선택 수정**: 하드코딩된 8가지 색상 옵션 추가
- **색상 미리보기**: 드롭다운에서 색상별 배경색 표시
- **사용자 경험 개험**: 색상 선택이 비어있는 문제 해결

### 🔄 네비게이션 개선
- **이전으로 버튼**: `history.back()` 사용으로 자연스러운 뒤로가기
- **검색 상태 복원**: 설정/등록 페이지에서 돌아와도 검색 상태 유지
- **다중 타이밍 복원**: 여러 시점에서 검색 상태 복원 시도

### 🛠️ 기술적 개선
- **옵션 로드 대기**: 지역 옵션이 로드된 후 검색 상태 복원
- **디버깅 강화**: 상세한 로그로 문제 추적 용이
- **에러 처리**: 검색 상태 복원 실패 시 안전한 대체 로직

---

## [v13.6.x] - 2025-01-11 🎨

### 🆕 색상 시스템 하드코딩
- **8가지 고정 색상**: 빨강, 주황, 노랑, 초록, 하늘, 파랑, 보라, 회색
- **색상 의미 커스터마이징**: 사용자별로 각 색상에 의미 설정 가능
- **방문일 자동 숨김**: 보라색과 회색 업체는 방문일 자동 숨김 처리
- **자동 새로고침**: 색상 의미 저장 시 자동 페이지 새로고침

### 📱 모바일 최적화
- **반응형 UI**: 768px 이하에서 세로 배치
- **터치 친화적**: 480px 이하에서 터치 크기 최적화
- **iOS 최적화**: 자동 줌 방지 (font-size: 16px)

---

## [v13.5.x] - 2024년 11월 📊

### 📊 데이터 관리 강화
- **엑셀 내보내기/가져오기**: 대량 업체 관리 지원
- **PDF 문서 관리**: 업체별 문서 첨부 및 관리
- **자동 통계 계산**: 방문 횟수 및 최근 방문일 자동 업데이트

### 🕸️ 업체 관계도
- **D3.js 네트워크 차트**: 인터랙티브 관계도 시각화
- **드래그 앤 드롭**: 관계도 노드 위치 조정 가능
- **실시간 연결**: 업체 클릭으로 상세 페이지 이동

---

## [v13.4.x] - 2024년 10월 🏗️

### 🏗️ 아키텍처 개선
- **모듈화**: JavaScript 코드 기능별 분리
- **캐싱 시스템**: 성능 최적화를 위한 데이터 캐싱
- **에러 핸들링**: 체계적인 에러 처리 시스템

### 📝 업무일지 시스템
- **방문 기록 관리**: 상세한 방문 정보 기록
- **검색 및 필터링**: 다양한 조건으로 일지 검색
- **통계 대시보드**: 방문 현황 시각적 표시

---

## [v13.3.x] - 2024년 9월 🚀

### 🚀 시스템 기반 구축
- **Supabase 연동**: PostgreSQL 백엔드 구축
- **Kakao OAuth**: 안전한 소셜 로그인 시스템
- **RLS 보안**: 사용자별 데이터 격리

### 👥 사용자 관리
- **다중 사용자**: 팀 단위 업체 관리 지원
- **권한 관리**: 역할별 접근 권한 제어
- **프로필 시스템**: 사용자 프로필 및 이미지

---

## 📈 로드맵

### 현재 상태 ✅
- 프로덕션 안정 운영
- 핵심 기능 완성
- 사용자 피드백 반영

### 다음 단계 🔄
- **실시간 알림**: 중요 업체 알림 시스템
- **고급 분석**: AI 기반 고객 분석
- **모바일 앱**: 네이티브 앱 버전

### 기술 개선 🛠️
- 테스트 자동화
- 성능 모니터링
- 문서화 완성

---

*📅 마지막 업데이트: 2025년 12월 5일*
*🏷️ 현재 버전: v13.7.2*
*🔗 프로덕션: https://namkyungsteel.com/worklog.html*