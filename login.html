<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <title>ë¡œê·¸ì¸ - ë‚¨ê²½ìŠ¤í‹¸(ì£¼)</title>
  <meta name="description" content="ë‚¨ê²½ìŠ¤í‹¸(ì£¼) ê´€ë¦¬ì ë¡œê·¸ì¸ í˜ì´ì§€ì…ë‹ˆë‹¤.">
  <meta name="keywords" content="ë‚¨ê²½ìŠ¤í‹¸, ë¡œê·¸ì¸, ê´€ë¦¬ì">

  <!-- Favicons -->
  <link href="logo.jpg" rel="icon">
  <link href="logo.jpg" rel="apple-touch-icon">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">

  <!-- Main CSS File -->
  <link href="assets/css/main.css" rel="stylesheet">
  
  <!-- Supabase JS CDN -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <!-- Database Manager -->
  <script src="database.js"></script>
  <!-- Domain Company Manager -->
  <script src="domain-company-manager.js"></script>

  <style>
    body {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Roboto', sans-serif;
    }

    .login-container {
      background: white;
      border-radius: 20px;
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
      padding: 40px;
      max-width: 500px;
      width: 100%;
      margin: 20px;
    }

    .login-header {
      text-align: center;
      margin-bottom: 30px;
    }

    .login-header h2 {
      color: #333;
      margin-bottom: 10px;
      font-weight: 700;
    }

    .login-header p {
      color: #666;
      margin: 0;
    }

    .form-group {
      margin-bottom: 15px;
    }

    .login-form .form-label {
      color: #333;
      font-weight: 500;
      margin-bottom: 8px;
      display: block;
    }

    .login-form .form-control {
      border: 2px solid #e1e5e9;
      border-radius: 10px;
      padding: 12px 15px;
      font-size: 16px;
      transition: all 0.3s ease;
    }

    .login-form .form-control:focus {
      border-color: #667eea;
      box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
    }

    .btn-login {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      border-radius: 10px;
      color: white;
      font-weight: 600;
      padding: 12px 30px;
      width: 100%;
      font-size: 16px;
      transition: all 0.3s ease;
    }

    .btn-login:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }

    .btn-login:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }

    .error-message {
      color: #dc3545;
      font-size: 14px;
      margin-top: 10px;
      text-align: center;
      display: none;
    }

    .back-link {
      text-align: center;
      margin-top: 20px;
    }

    .back-link a {
      color: #667eea;
      text-decoration: none;
      font-weight: 500;
    }

    .back-link a:hover {
      text-decoration: underline;
    }

    .logo {
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 20px;
    }

    .logo i {
      color: white;
      font-size: 24px;
    }

    .auth-tabs {
      display: flex;
      margin-bottom: 30px;
      border-radius: 10px;
      overflow: hidden;
      border: 2px solid #e1e5e9;
    }

    .auth-tab {
      flex: 1;
      padding: 12px;
      background: #f8f9fa;
      border: none;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .auth-tab.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .auth-form {
      display: none;
    }

    .auth-form.active {
      display: block;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 15px;
      align-items: start;
    }

    .form-row .form-group {
      margin-bottom: 0;
      display: flex;
      flex-direction: column;
      min-height: 70px;
    }

    .form-row .form-group .form-label {
      height: 20px;
      display: flex;
      align-items: center;
      margin-bottom: 5px;
    }

    .form-row .form-group .form-control {
      height: 40px;
      display: flex;
      align-items: center;
    }

    .form-row.single-column {
      grid-template-columns: 1fr;
    }

    @media (max-width: 576px) {
      .form-row {
        grid-template-columns: 1fr;
        gap: 15px;
      }
      
      .login-container {
        padding: 30px 20px;
        margin: 10px;
        max-width: 100%;
      }
    }

    select.form-control {
      background-color: white;
      background-image: url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 4 5'%3E%3Cpath fill='%23666' d='M2 0L0 2h4zm0 5L0 3h4z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 12px center;
      background-size: 12px;
      padding-right: 35px;
    }

    .success-message {
      color: #28a745;
      font-size: 14px;
      margin-top: 10px;
      text-align: center;
      display: none;
    }

    .form-section {
      margin-bottom: 25px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 12px;
      border: 1px solid #e9ecef;
    }

    .section-title {
      color: #495057;
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 15px;
      padding-bottom: 8px;
      border-bottom: 2px solid #e9ecef;
    }

    .form-control {
      border: 1px solid #dee2e6;
      border-radius: 8px;
      padding: 10px 12px;
      font-size: 14px;
      transition: all 0.2s ease;
      background: white;
    }

    .form-control:focus {
      border-color: #667eea;
      box-shadow: 0 0 0 0.15rem rgba(102, 126, 234, 0.15);
      background: white;
    }

    .form-label {
      font-size: 13px;
      font-weight: 500;
      color: #495057;
      margin-bottom: 5px;
    }

    /* êµ¬ê¸€ ë¡œê·¸ì¸ ìŠ¤íƒ€ì¼ */
    .divider {
      text-align: center;
      margin: 20px 0;
      position: relative;
    }

    .divider::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 0;
      right: 0;
      height: 1px;
      background: #dee2e6;
    }

    .divider span {
      background: white;
      padding: 0 15px;
      color: #6c757d;
      font-size: 14px;
    }

    .btn-google {
      width: 100%;
      padding: 12px 20px;
      border: 1px solid #dadce0;
      border-radius: 8px;
      background: white;
      color: #3c4043;
      font-size: 14px;
      font-weight: 500;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
      margin-bottom: 15px;
    }

    .btn-google:hover {
      box-shadow: 0 1px 2px 0 rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
      border-color: #dadce0;
      background: #f8f9fa;
    }

    .btn-google:active {
      background: #f1f3f4;
      box-shadow: 0 1px 2px 0 rgba(60, 64, 67, 0.3);
    }

    .btn-kakao {
      width: 100%;
      padding: 12px 20px;
      border: 1px solid #FEE500;
      border-radius: 8px;
      background: #FEE500;
      color: #3C1E1E;
      font-size: 14px;
      font-weight: 500;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
      margin-bottom: 15px;
    }

    .btn-kakao:hover {
      background: #FDD835;
      border-color: #FDD835;
      box-shadow: 0 1px 2px 0 rgba(60, 30, 30, 0.3), 0 1px 3px 1px rgba(60, 30, 30, 0.15);
    }

    .btn-kakao:active {
      background: #F9A825;
      box-shadow: 0 1px 2px 0 rgba(60, 30, 30, 0.3);
    }
  </style>
</head>

<body>
  <div class="login-container">
    <div class="login-header">
      <div class="logo">
        <i class="bi bi-building"></i>
      </div>
      <h2>ë‚¨ê²½ìŠ¤í‹¸(ì£¼)</h2>
    </div>

    <!-- íƒ­ ë©”ë‰´ -->
    <div class="auth-tabs">
      <button class="auth-tab active" onclick="switchTab('login')" type="button">ë¡œê·¸ì¸</button>
      <button class="auth-tab" onclick="switchTab('register')" type="button">íšŒì›ê°€ì…</button>
    </div>

    <!-- ë¡œê·¸ì¸ í¼ -->
    <div id="loginForm" class="auth-form active login-form">
      <form id="loginFormSubmit">
        <div class="form-group">
          <label for="loginEmail" class="form-label">ì´ë©”ì¼</label>
          <input type="email" class="form-control" id="loginEmail" placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”" required>
        </div>

        <div class="form-group">
          <label for="loginPassword" class="form-label">ë¹„ë°€ë²ˆí˜¸</label>
          <input type="password" class="form-control" id="loginPassword" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" required>
        </div>

        <button type="submit" class="btn btn-login" id="loginBtn">
          <span class="btn-text">ë¡œê·¸ì¸</span>
          <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
        </button>

        <!-- êµ¬ë¶„ì„  -->
        <div class="divider">
          <span>ë˜ëŠ”</span>
        </div>

        <!-- êµ¬ê¸€ ë¡œê·¸ì¸ ë²„íŠ¼ -->
        <button type="button" class="btn btn-google" id="googleLoginBtn" onclick="handleGoogleLogin()">
          <svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
            <g fill="none" fill-rule="evenodd">
              <path d="M17.64 9.205c0-.639-.057-1.252-.164-1.841H9v3.481h4.844a4.14 4.14 0 0 1-1.796 2.716v2.259h2.908c1.702-1.567 2.684-3.875 2.684-6.615z" fill="#4285F4"/>
              <path d="M9 18c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332A8.997 8.997 0 0 0 9 18z" fill="#34A853"/>
              <path d="M3.964 10.71A5.41 5.41 0 0 1 3.682 9c0-.593.102-1.17.282-1.71V4.958H.957A8.996 8.996 0 0 0 0 9c0 1.452.348 2.827.957 4.042l3.007-2.332z" fill="#FBBC05"/>
              <path d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0A8.997 8.997 0 0 0 .957 4.958L3.964 7.29C4.672 5.163 6.656 3.58 9 3.58z" fill="#EA4335"/>
            </g>
          </svg>
          <span>Googleë¡œ ë¡œê·¸ì¸</span>
        </button>

        <!-- ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ë²„íŠ¼ -->
        <button type="button" class="btn btn-kakao" id="kakaoLoginBtn" onclick="handleKakaoLogin()">
          <svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
            <g fill="none" fill-rule="evenodd">
              <path d="M9 0C4.03 0 0 3.13 0 7c0 2.52 1.67 4.74 4.19 6.04L3.5 16.5c-.13.47.35.85.76.6l3.92-2.65c.28.02.55.05.82.05 4.97 0 9-3.13 9-7S13.97 0 9 0z" fill="#3C1E1E"/>
            </g>
          </svg>
          <span>ì¹´ì¹´ì˜¤ë¡œ ë¡œê·¸ì¸</span>
        </button>

        <div class="error-message" id="loginErrorMessage">
          ì´ë©”ì¼ ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.
        </div>
      </form>
    </div>

    <!-- íšŒì›ê°€ì… í¼ -->
    <div id="registerForm" class="auth-form">
      <form id="registerFormSubmit">
        <!-- ê¸°ë³¸ ì •ë³´ ì„¹ì…˜ -->
        <div class="form-section">
          <h4 class="section-title">ê¸°ë³¸ ì •ë³´</h4>
          
          <div class="form-row">
            <div class="form-group">
              <label for="registerName" class="form-label">ì´ë¦„ *</label>
              <input type="text" class="form-control" id="registerName" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" required>
            </div>
            <div class="form-group">
              <label for="registerEmail" class="form-label">ì´ë©”ì¼ *</label>
              <input type="email" class="form-control" id="registerEmail" placeholder="example@company.com" required>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="registerPassword" class="form-label">ë¹„ë°€ë²ˆí˜¸ *</label>
              <input type="password" class="form-control" id="registerPassword" placeholder="6ì ì´ìƒ ì…ë ¥í•˜ì„¸ìš”" required>
            </div>
            <div class="form-group">
              <label for="confirmPassword" class="form-label">ë¹„ë°€ë²ˆí˜¸ í™•ì¸ *</label>
              <input type="password" class="form-control" id="confirmPassword" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ì…ë ¥í•˜ì„¸ìš”" required>
            </div>
          </div>
        </div>

        <!-- íšŒì‚¬ ì •ë³´ ì„¹ì…˜ -->
        <div class="form-section">
          <h4 class="section-title">íšŒì‚¬ ì •ë³´</h4>
          
          <div class="form-row">
            <div class="form-group">
              <label for="registerRole" class="form-label">ê¶Œí•œ *</label>
              <select class="form-control" id="registerRole" required>
                <option value="">ê¶Œí•œì„ ì„ íƒí•˜ì„¸ìš”</option>
                <option value="employee">ì§ì›</option>
                <option value="manager">ê´€ë¦¬ì</option>
              </select>
            </div>
            <div class="form-group">
              <label for="registerPhone" class="form-label">ì—°ë½ì²˜</label>
              <input type="tel" class="form-control" id="registerPhone" placeholder="010-1234-5678">
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="registerDepartment" class="form-label">ì†Œì† ë¶€ì„œ</label>
              <select class="form-control" id="registerDepartment">
                <option value="">ë¶€ì„œë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                <option value="ì˜ì—…ë¶€">ì˜ì—…ë¶€</option>
                <option value="ìƒì‚°ë¶€">ìƒì‚°ë¶€</option>
                <option value="í’ˆì§ˆê´€ë¦¬ë¶€">í’ˆì§ˆê´€ë¦¬ë¶€</option>
                <option value="ê´€ë¦¬ë¶€">ê´€ë¦¬ë¶€</option>
                <option value="ê¸°ìˆ ë¶€">ê¸°ìˆ ë¶€</option>
              </select>
            </div>
            <div class="form-group">
              <label for="registerPosition" class="form-label">ì§ì±…</label>
              <select class="form-control" id="registerPosition">
                <option value="">ì§ì±…ì„ ì„ íƒí•˜ì„¸ìš”</option>
                <option value="ì‚¬ì›">ì‚¬ì›</option>
                <option value="ì£¼ì„">ì£¼ì„</option>
                <option value="ëŒ€ë¦¬">ëŒ€ë¦¬</option>
                <option value="ê³¼ì¥">ê³¼ì¥</option>
                <option value="ì°¨ì¥">ì°¨ì¥</option>
                <option value="ë¶€ì¥">ë¶€ì¥</option>
                <option value="ì´ì‚¬">ì´ì‚¬</option>
              </select>
            </div>
          </div>
        </div>

        <button type="submit" class="btn btn-login" id="registerBtn">
          <span class="btn-text">íšŒì›ê°€ì…</span>
          <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
        </button>

        <div class="error-message" id="registerErrorMessage">
          ì…ë ¥ ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
        </div>

        <div class="success-message" id="registerSuccessMessage">
          íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!
        </div>
      </form>
    </div>

    <div class="back-link">
      <a href="index.html">
        <i class="bi bi-arrow-left"></i> í™ˆí˜ì´ì§€ë¡œ ëŒì•„ê°€ê¸°
      </a>
    </div>
  </div>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>

  <!-- Main JS File -->
  <script src="assets/js/main.js"></script>
  
  <!-- Auth JS File -->
  <script src="shared-assets/js/auth.js"></script>

  <script>
    // íƒ­ ì „í™˜ ê¸°ëŠ¥
    function switchTab(tab) {
      console.log('íƒ­ ì „í™˜:', tab);
      
      // ëª¨ë“  íƒ­ ë²„íŠ¼ì—ì„œ active í´ë˜ìŠ¤ ì œê±°
      const allTabs = document.querySelectorAll('.auth-tab');
      allTabs.forEach(btn => btn.classList.remove('active'));
      
      // ëª¨ë“  í¼ì—ì„œ active í´ë˜ìŠ¤ ì œê±°
      const allForms = document.querySelectorAll('.auth-form');
      allForms.forEach(form => form.classList.remove('active'));
      
      // í´ë¦­ëœ íƒ­ í™œì„±í™”
      if (event && event.target) {
        event.target.classList.add('active');
      }
      
      // í•´ë‹¹ í¼ í™œì„±í™”
      const targetForm = document.getElementById(tab + 'Form');
      if (targetForm) {
        targetForm.classList.add('active');
        console.log(tab + ' í¼ í™œì„±í™”ë¨');
      } else {
        console.error(tab + ' í¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ');
      }
    }
    
    // ì§ì ‘ íƒ­ ì „í™˜ í•¨ìˆ˜ë“¤ ì¶”ê°€
    function showLogin() {
      switchTab('login');
    }
    
    function showRegister() {
      switchTab('register');
    }

    // ë¡œê·¸ì¸ í¼ ì²˜ë¦¬
    document.getElementById('loginFormSubmit').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;
      const errorMessage = document.getElementById('loginErrorMessage');
      const loginBtn = document.getElementById('loginBtn');
      const btnText = loginBtn.querySelector('.btn-text');
      const spinner = loginBtn.querySelector('.spinner-border');
      
      // ë²„íŠ¼ ë¡œë”© ìƒíƒœ
      loginBtn.disabled = true;
      btnText.textContent = 'ë¡œê·¸ì¸ ì¤‘...';
      spinner.classList.remove('d-none');
      errorMessage.style.display = 'none';
      
      try {
        console.log('ğŸ” ë¡œê·¸ì¸ ì‹œë„ ì‹œì‘ - AuthManager ì‚¬ìš©');
        console.log('ğŸ“§ ì´ë©”ì¼:', email);
        
        // AuthManagerë¥¼ ì‚¬ìš©í•˜ì—¬ ì¸ì¦ (í†µí•©ëœ ì¸ì¦ ì‹œìŠ¤í…œ)
        if (typeof AuthManager === 'undefined') {
          throw new Error('AuthManagerê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
        }
        
        const result = await AuthManager.login(email, password);
        
        if (!result.success || !result.user) {
          throw new Error(result.message || 'ë¡œê·¸ì¸ ì •ë³´ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
        }

        // ë¡œê·¸ì¸ ì„±ê³µ
        localStorage.setItem('currentUser', JSON.stringify(result.user));
        localStorage.setItem('userRole', result.user.role);
        localStorage.setItem('userName', result.user.name);
        
        btnText.textContent = 'ë¡œê·¸ì¸ ì„±ê³µ!';
        spinner.classList.add('d-none');
        
        // ì—­í• ì— ë”°ë¥¸ í˜ì´ì§€ ì´ë™
        setTimeout(() => {
          if (result.user.role === 'master_admin') {
            window.location.href = 'master-dashboard.html';
          } else {
            window.location.href = 'employee-dashboard.html';
          }
        }, 1000);
        
      } catch (error) {
        // ë¡œê·¸ì¸ ì‹¤íŒ¨
        console.error('ë¡œê·¸ì¸ ì˜¤ë¥˜:', error);
        loginBtn.disabled = false;
        btnText.textContent = 'ë¡œê·¸ì¸';
        spinner.classList.add('d-none');
        errorMessage.style.display = 'block';
        errorMessage.textContent = error.message || 'ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
        
        // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
        document.getElementById('loginPassword').value = '';
        document.getElementById('loginEmail').focus();
      }
    });

    // íšŒì›ê°€ì… í¼ ì²˜ë¦¬
    document.getElementById('registerFormSubmit').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const name = document.getElementById('registerName').value;
      const email = document.getElementById('registerEmail').value;
      const password = document.getElementById('registerPassword').value;
      const confirmPassword = document.getElementById('confirmPassword').value;
      const role = document.getElementById('registerRole').value;
      const phone = document.getElementById('registerPhone').value;
      const department = document.getElementById('registerDepartment').value;
      const position = document.getElementById('registerPosition').value;
      
      const errorMessage = document.getElementById('registerErrorMessage');
      const successMessage = document.getElementById('registerSuccessMessage');
      const registerBtn = document.getElementById('registerBtn');
      const btnText = registerBtn.querySelector('.btn-text');
      const spinner = registerBtn.querySelector('.spinner-border');
      
      // ì´ˆê¸°í™”
      errorMessage.style.display = 'none';
      successMessage.style.display = 'none';
      
      // ìœ íš¨ì„± ê²€ì‚¬
      if (!name || !email || !password || !role) {
        errorMessage.textContent = 'í•„ìˆ˜ í•­ëª©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.';
        errorMessage.style.display = 'block';
        return;
      }
      
      if (password !== confirmPassword) {
        errorMessage.textContent = 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.';
        errorMessage.style.display = 'block';
        return;
      }
      
      if (password.length < 6) {
        errorMessage.textContent = 'ë¹„ë°€ë²ˆí˜¸ëŠ” 6ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.';
        errorMessage.style.display = 'block';
        return;
      }
      
      // ë²„íŠ¼ ë¡œë”© ìƒíƒœ
      registerBtn.disabled = true;
      btnText.textContent = 'ê°€ì… ì¤‘...';
      spinner.classList.remove('d-none');
      
      // AuthManagerë¥¼ ì‚¬ìš©í•˜ì—¬ íšŒì›ê°€ì… ì²˜ë¦¬
      try {
          console.log('ğŸ”„ íšŒì›ê°€ì… ì‹œì‘ - AuthManager ì‚¬ìš©');
          
          // AuthManager í™•ì¸
          if (typeof AuthManager === 'undefined') {
              throw new Error('AuthManagerê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
          }
          
          const userData = {
              email: email,
              password: password,
              name: name,
              phone: phone,
              role: role || 'employee',
              department: department || '',
              position: position || ''
          };
          
          console.log('ğŸ“¤ íšŒì›ê°€ì… ë°ì´í„°:', userData);
          
          const result = await AuthManager.register(userData);
          
          console.log('ğŸ“¥ íšŒì›ê°€ì… ì‘ë‹µ:', result);
          
          if (!result.success) {
              throw new Error(result.message || 'íšŒì›ê°€ì…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
          }
          
          console.log('âœ… íšŒì›ê°€ì… ì™„ë£Œ:', result.user);
          
          // ì„±ê³µ ì²˜ë¦¬
          btnText.textContent = 'ê°€ì… ì™„ë£Œ!';
          spinner.classList.add('d-none');
          successMessage.style.display = 'block';
          
          // í¼ ì´ˆê¸°í™”
          document.getElementById('registerFormSubmit').reset();
          
          // 3ì´ˆ í›„ ë¡œê·¸ì¸ íƒ­ìœ¼ë¡œ ì „í™˜
          setTimeout(() => {
            switchTab('login');
            registerBtn.disabled = false;
            btnText.textContent = 'íšŒì›ê°€ì…';
            successMessage.style.display = 'none';
          }, 3000);
          
      } catch (error) {
          console.error('âŒ íšŒì›ê°€ì… ì˜¤ë¥˜ ìƒì„¸:', {
              message: error.message,
              stack: error.stack,
              error: error
          });
          // ì˜¤ë¥˜ í‘œì‹œ
          registerBtn.disabled = false;
          btnText.textContent = 'íšŒì›ê°€ì…';
          spinner.classList.add('d-none');
          errorMessage.textContent = error.message || 'íšŒì›ê°€ì…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
          errorMessage.style.display = 'block';
      }
    });

    // êµ¬ê¸€ ë¡œê·¸ì¸ í•¸ë“¤ëŸ¬
    async function handleGoogleLogin() {
      console.log('ğŸ” êµ¬ê¸€ ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­');
      
      const googleBtn = document.getElementById('googleLoginBtn');
      const originalText = googleBtn.innerHTML;
      
      // ë²„íŠ¼ ë¡œë”© ìƒíƒœ
      googleBtn.disabled = true;
      googleBtn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> <span>Google ë¡œê·¸ì¸ ì¤‘...</span>';
      
      try {
        if (typeof AuthManager === 'undefined') {
          throw new Error('AuthManagerê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
        }
        
        const result = await AuthManager.googleLogin();
        
        if (result.success) {
          console.log('âœ… êµ¬ê¸€ ë¡œê·¸ì¸ ì‹œì‘:', result.message);
          // OAuth ë¦¬ë‹¤ì´ë ‰íŠ¸ê°€ ì²˜ë¦¬ë¨
        } else {
          throw new Error(result.message || 'êµ¬ê¸€ ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
        }
        
      } catch (error) {
        console.error('âŒ êµ¬ê¸€ ë¡œê·¸ì¸ ì˜¤ë¥˜:', error);
        alert(error.message || 'êµ¬ê¸€ ë¡œê·¸ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        
        // ë²„íŠ¼ ë³µì›
        googleBtn.disabled = false;
        googleBtn.innerHTML = originalText;
      }
    }

    // ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í•¸ë“¤ëŸ¬
    async function handleKakaoLogin() {
      console.log('ğŸ” ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­');
      
      const kakaoBtn = document.getElementById('kakaoLoginBtn');
      const originalText = kakaoBtn.innerHTML;
      
      // ë²„íŠ¼ ë¡œë”© ìƒíƒœ
      kakaoBtn.disabled = true;
      kakaoBtn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> <span>ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì¤‘...</span>';
      
      try {
        if (typeof AuthManager === 'undefined') {
          throw new Error('AuthManagerê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
        }
        
        const result = await AuthManager.kakaoLogin();
        
        if (result.success) {
          console.log('âœ… ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì‹œì‘:', result.message);
          // OAuth ë¦¬ë‹¤ì´ë ‰íŠ¸ê°€ ì²˜ë¦¬ë¨
        } else {
          throw new Error(result.message || 'ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
        }
        
      } catch (error) {
        console.error('âŒ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì˜¤ë¥˜:', error);
        alert(error.message || 'ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        
        // ë²„íŠ¼ ë³µì›
        kakaoBtn.disabled = false;
        kakaoBtn.innerHTML = originalText;
      }
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ OAuth ì½œë°± ì²˜ë¦¬
    document.addEventListener('DOMContentLoaded', async function() {
      // URLì— OAuth ê´€ë ¨ íŒŒë¼ë¯¸í„°ê°€ ìˆëŠ”ì§€ í™•ì¸
      const urlParams = new URLSearchParams(window.location.search);
      if (urlParams.get('code') || window.location.hash.includes('access_token')) {
        console.log('ğŸ” OAuth ì½œë°± ê°ì§€ë¨');
        
        try {
          if (typeof AuthManager !== 'undefined') {
            const result = await AuthManager.handleOAuthCallback();
            
            if (result.success) {
              console.log('âœ… OAuth ë¡œê·¸ì¸ ì™„ë£Œ, ëŒ€ì‹œë³´ë“œë¡œ ì´ë™');
              window.location.href = 'employee-dashboard.html';
            } else {
              console.error('âŒ OAuth ì²˜ë¦¬ ì‹¤íŒ¨:', result.message);
              alert('ë¡œê·¸ì¸ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + result.message);
            }
          }
        } catch (error) {
          console.error('âŒ OAuth ì½œë°± ì²˜ë¦¬ ì˜¤ë¥˜:', error);
          alert('ë¡œê·¸ì¸ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
      }
    });

    // AOS ì´ˆê¸°í™”
    AOS.init();

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ìƒíƒœ ì„¤ì •
    document.addEventListener('DOMContentLoaded', function() {
      console.log('í˜ì´ì§€ ë¡œë“œë¨ - ì´ˆê¸° ìƒíƒœ ì„¤ì •');
      
      // ë¡œê·¸ì¸ íƒ­ì´ ê¸°ë³¸ìœ¼ë¡œ í™œì„±í™”ë˜ë„ë¡ í™•ì‹¤íˆ ì„¤ì •
      document.querySelectorAll('.auth-tab').forEach(btn => btn.classList.remove('active'));
      document.querySelectorAll('.auth-form').forEach(form => form.classList.remove('active'));
      
      // ë¡œê·¸ì¸ íƒ­ê³¼ í¼ í™œì„±í™”
      const loginTab = document.querySelector('[onclick*="login"]');
      const loginForm = document.getElementById('loginForm');
      
      if (loginTab) loginTab.classList.add('active');
      if (loginForm) loginForm.classList.add('active');
      
      // íƒ­ ë²„íŠ¼ì— ì¶”ê°€ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
      const tabs = document.querySelectorAll('.auth-tab');
      tabs.forEach((tab, index) => {
        tab.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          
          if (index === 0) {
            // ë¡œê·¸ì¸ íƒ­
            switchTab('login');
          } else if (index === 1) {
            // íšŒì›ê°€ì… íƒ­
            switchTab('register');
          }
        });
      });
      
      console.log('ì´ˆê¸° ìƒíƒœ ì„¤ì • ì™„ë£Œ - íƒ­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€ë¨');
    });

    // ì—”í„° í‚¤ ì´ë²¤íŠ¸ (í˜„ì¬ í™œì„±í™”ëœ í¼ì—ì„œë§Œ)
    document.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        const activeForm = document.querySelector('.auth-form.active form');
        if (activeForm) {
          activeForm.dispatchEvent(new Event('submit'));
        }
      }
    });

    // ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì‹¤ì‹œê°„ ì²´í¬
    document.getElementById('confirmPassword').addEventListener('input', function() {
      const password = document.getElementById('registerPassword').value;
      const confirmPassword = this.value;
      const errorMessage = document.getElementById('registerErrorMessage');
      
      if (confirmPassword && password !== confirmPassword) {
        this.style.borderColor = '#dc3545';
        errorMessage.textContent = 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.';
        errorMessage.style.display = 'block';
      } else {
        this.style.borderColor = '#e1e5e9';
        errorMessage.style.display = 'none';
      }
    });
  </script>
</body>

</html>