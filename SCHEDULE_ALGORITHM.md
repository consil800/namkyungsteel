# 스케줄 생성 알고리즘 v6.1

> schedule-generator.js 상세 설명

## 개요

철강 영업팀의 방문 스케줄을 자동 생성합니다.
- **점수 기반 우선순위**로 업체 선정
- **TSP 알고리즘**으로 경로 최적화

## 우선순위 점수 (낮을수록 우선)

| 항목 | 설명 |
|------|------|
| 방문 오래된 업체 | staleDays 30일 cap (0~10점) |
| 방문 횟수 적은 업체 | visit_count 기반 |
| 월 2회 제한 | 월 3회 이상 방문 차단 |
| 지역 쿨다운 | 같은 지역 3~4일 연속 방문 억제 |
| 월/금 근거리 우선 | 본사 60km 이내 보너스 |
| 이동비용 페널티 | 먼 업체일수록 우선순위 하향 |

## 경로 최적화

1. **Nearest Neighbor**: 가장 가까운 업체 순서로 초기 경로 생성
2. **2-opt 개선**: 교차 경로 제거하여 총 이동거리 단축

## 핵심 설정

```
본사 좌표: 35.1547, 128.9914 (부산 사상구)
월/금 보너스: 60km 이내 최대 20점
```

| 방문 옵션 | min | max | target |
|----------|-----|-----|--------|
| 1~3개 | 1 | 3 | 2 |
| 4~5개 | 4 | 5 | 5 |
| 6~8개 | 6 | 8 | 7 |
| 9~11개 | 9 | 11 | 10 |

## 제약 완화 (Relaxation)

후보 부족 시 단계적 완화:

| Level | 월 제한 | 지역 쿨다운 |
|-------|---------|-------------|
| 0 | 2회 | 3일 |
| 1 | 3회 | 2일 |
| 2 | 무제한 | 1일 |

## 저장/불러오기

- **저장**: Supabase `visit_schedule_plans` 테이블
- **불러오기**: 저장된 스케줄 목록에서 선택

---
*최종 업데이트: 2026-01-05*
